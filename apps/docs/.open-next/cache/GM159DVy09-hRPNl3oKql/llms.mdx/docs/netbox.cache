{"type":"route","meta":{"status":200,"headers":{"content-type":"text/markdown","x-next-cache-tags":"_N_T_/layout,_N_T_/llms.mdx/layout,_N_T_/llms.mdx/docs/layout,_N_T_/llms.mdx/docs/[[...slug]]/layout,_N_T_/llms.mdx/docs/[[...slug]]/route,_N_T_/llms.mdx/docs/netbox"}},"body":"# NetBox Integration\n\n\n\nNetBox からネットワーク構成を取得し、Shumoku ダイアグラムを自動生成します。\n\n## インストール\n\n<Tabs items={['npm', 'yarn', 'pnpm', 'bun']}>\n  <Tab value=\"npm\">\n    ```bash\n    npm install @shumoku/netbox\n    ```\n  </Tab>\n\n  <Tab value=\"yarn\">\n    ```bash\n    yarn add @shumoku/netbox\n    ```\n  </Tab>\n\n  <Tab value=\"pnpm\">\n    ```bash\n    pnpm add @shumoku/netbox\n    ```\n  </Tab>\n\n  <Tab value=\"bun\">\n    ```bash\n    bun add @shumoku/netbox\n    ```\n  </Tab>\n</Tabs>\n\n## CLI での使用\n\nコマンドラインから NetBox データを Shumoku YAML に変換できます。\n\n```bash\n# 基本的な使い方\nnpx netbox-to-shumoku --url https://netbox.example.com --token YOUR_API_TOKEN\n\n# ファイルに出力\nnpx netbox-to-shumoku --url https://netbox.example.com --token YOUR_API_TOKEN -o network.yaml\n\n# サイトでフィルタリング\nnpx netbox-to-shumoku --url https://netbox.example.com --token YOUR_API_TOKEN --site tokyo-dc\n```\n\n### CLI オプション\n\n| オプション          | 説明               |\n| -------------- | ---------------- |\n| `--url, -u`    | NetBox の URL（必須） |\n| `--token, -t`  | API トークン（必須）     |\n| `--output, -o` | 出力ファイル（省略時は標準出力） |\n| `--site, -s`   | サイトでフィルタリング      |\n| `--role, -r`   | デバイスロールでフィルタリング  |\n\n## ライブラリとしての使用\n\n### 基本的な使い方\n\n```typescript\nimport { NetBoxClient, convertToShumoku } from '@shumoku/netbox'\nimport { HierarchicalLayoutEngine, SvgRenderer } from '@shumoku/core'\n\n// NetBox クライアントを作成\nconst client = new NetBoxClient({\n  url: 'https://netbox.example.com',\n  token: 'your-api-token'\n})\n\n// デバイスとケーブルを取得\nconst devices = await client.getDevices()\nconst cables = await client.getCables()\n\n// Shumoku NetworkGraph に変換\nconst graph = convertToShumoku({ devices, cables })\n\n// レイアウトとレンダリング\nconst engine = new HierarchicalLayoutEngine()\nconst layout = await engine.layout(graph)\n\nconst renderer = new SvgRenderer()\nconst svg = renderer.render(layout)\n```\n\n### サイト情報を含める\n\n```typescript\nconst devices = await client.getDevices()\nconst cables = await client.getCables()\nconst sites = await client.getSites()\n\nconst graph = convertToShumoku({\n  devices,\n  cables,\n  sites  // サイトを subgraph として変換\n})\n```\n\n### フィルタリング\n\n```typescript\n// 特定のサイトのデバイスのみ取得\nconst devices = await client.getDevices({\n  site: 'tokyo-dc'\n})\n\n// 特定のロールのデバイスのみ取得\nconst devices = await client.getDevices({\n  role: 'core-router'\n})\n\n// 複数条件\nconst devices = await client.getDevices({\n  site: 'tokyo-dc',\n  role: 'core-router',\n  status: 'active'\n})\n```\n\n## API Reference\n\n### NetBoxClient\n\n```typescript\ninterface NetBoxClientOptions {\n  url: string      // NetBox の URL\n  token: string    // API トークン\n}\n\nconst client = new NetBoxClient(options)\n```\n\n#### getDevices\n\n```typescript\ninterface DeviceFilter {\n  site?: string\n  role?: string\n  status?: 'active' | 'planned' | 'staged' | 'failed' | 'offline'\n  manufacturer?: string\n  model?: string\n}\n\nclient.getDevices(filter?: DeviceFilter): Promise<NetBoxDevice[]>\n```\n\n#### getCables\n\n```typescript\nclient.getCables(): Promise<NetBoxCable[]>\n```\n\n#### getSites\n\n```typescript\nclient.getSites(): Promise<NetBoxSite[]>\n```\n\n### convertToShumoku\n\n```typescript\ninterface ConvertOptions {\n  devices: NetBoxDevice[]\n  cables: NetBoxCable[]\n  sites?: NetBoxSite[]\n}\n\nconvertToShumoku(options: ConvertOptions): NetworkGraph\n```\n\n## NetBox のセットアップ\n\n### API トークンの取得\n\n1. NetBox にログイン\n2. 右上のユーザーメニュー → **API Tokens**\n3. **Add a token** をクリック\n4. 必要な権限を設定してトークンを作成\n\n### 必要な権限\n\n読み取り専用の場合、以下の権限が必要です：\n\n* `dcim.view_device`\n* `dcim.view_cable`\n* `dcim.view_site`\n* `dcim.view_interface`\n\n## データマッピング\n\nNetBox のデータは以下のように Shumoku に変換されます：\n\n| NetBox      | Shumoku     |\n| ----------- | ----------- |\n| Device      | Node        |\n| Cable       | Link        |\n| Site        | Subgraph    |\n| Interface   | Port        |\n| Device Role | type の推測に使用 |\n\n### デバイスタイプの自動推測\n\nNetBox の `device_role` から Shumoku の `type` を自動推測します：\n\n| NetBox Device Role                 | Shumoku Type    |\n| ---------------------------------- | --------------- |\n| `router`, `core-router`            | `router`        |\n| `switch`, `access-switch`          | `l2-switch`     |\n| `l3-switch`, `distribution-switch` | `l3-switch`     |\n| `firewall`                         | `firewall`      |\n| `server`, `compute`                | `server`        |\n| `access-point`, `wireless`         | `access-point`  |\n| `load-balancer`                    | `load-balancer` |\n\n## トラブルシューティング\n\n### 接続エラー\n\n```\nError: Failed to connect to NetBox\n```\n\n* URL が正しいか確認\n* API トークンが有効か確認\n* ネットワーク接続を確認\n\n### 権限エラー\n\n```\nError: 403 Forbidden\n```\n\n* API トークンの権限を確認\n* 必要な権限が付与されているか確認\n\n### デバイスが表示されない\n\n* デバイスのステータスが `active` か確認\n* フィルタ条件を確認\n* NetBox でデバイスが正しく登録されているか確認\n"}